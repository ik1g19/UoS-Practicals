<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Access Structures Index Basics Relations are stored in files
Files are stored as collections of blocks
How do we find tuples that match some criteria?"><meta property="og:title" content="Week 3"><meta property="og:description" content="Access Structures Index Basics Relations are stored in files
Files are stored as collections of blocks
How do we find tuples that match some criteria?"><meta property="og:type" content="website"><meta property="og:image" content="https://ik1g19.github.io/UoS-Notes/icon.png"><meta property="og:url" content="https://ik1g19.github.io/UoS-Notes/notes/Advanced-Databases/Week-3/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Week 3"><meta name=twitter:description content="Access Structures Index Basics Relations are stored in files
Files are stored as collections of blocks
How do we find tuples that match some criteria?"><meta name=twitter:image content="https://ik1g19.github.io/UoS-Notes/icon.png"><meta name=twitter:site content="_jzhao"><title>Week 3</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://ik1g19.github.io/UoS-Notes//icon.png><link href=https://ik1g19.github.io/UoS-Notes/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://ik1g19.github.io/UoS-Notes/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://ik1g19.github.io/UoS-Notes/js/darkmode.fdbb50a651b073e7d85910aebde4469d.min.js></script>
<script src=https://ik1g19.github.io/UoS-Notes/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script async src=https://ik1g19.github.io/UoS-Notes/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://ik1g19.github.io/UoS-Notes/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://ik1g19.github.io/UoS-Notes/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://ik1g19.github.io/UoS-Notes/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://ik1g19.github.io/UoS-Notes/",fetchData=Promise.all([fetch("https://ik1g19.github.io/UoS-Notes/indices/linkIndex.4cd7744b37da745103d2e306cd2cd001.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://ik1g19.github.io/UoS-Notes/indices/contentIndex.a1e306a3e6a8cedcc8275a04564ca752.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://ik1g19.github.io/UoS-Notes",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://ik1g19.github.io/UoS-Notes",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/ik1g19.github.io\/UoS-Notes\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=ik1g19.github.io/UoS-Notes src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://ik1g19.github.io/UoS-Notes/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://ik1g19.github.io/UoS-Notes/>My UoS Notes</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Week 3</h1><p class=meta>Last updated
Apr 16, 2023
<a href=https://github.com/ik1g19/notes/Advanced%20Databases/Week%203.md rel=noopener>Edit Source</a></p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#index-basics>Index Basics</a><ol><li><a href=#indexing-trade-offs>Indexing Trade Offs</a></li><li><a href=#sequential-files>Sequential Files</a></li></ol></li><li><a href=#dense-index>Dense Index</a></li><li><a href=#sparse-index>Sparse Index</a></li><li><a href=#multi-level-index>Multi-level Index</a></li><li><a href=#notes-on-pointers>Notes on Pointers</a></li><li><a href=#sparse-vs-dense-tradeoff>Sparse vs. Dense Tradeoff</a></li><li><a href=#duplicate-keys>Duplicate Keys</a><ol><li><a href=#dense-index-approach-1>Dense Index Approach #1</a></li><li><a href=#dense-index-approach-2>Dense Index Approach #2</a></li><li><a href=#spare-index-approach-1->Spare Index Approach #1 ↓</a></li><li><a href=#sparse-index-approach-2->Sparse Index Approach #2 ↓</a></li></ol></li><li><a href=#deletion-from-sparse-index>Deletion from Sparse Index</a></li><li><a href=#deletion-from-dense-index>Deletion from Dense Index</a></li><li><a href=#insertion-into-sparse-index>Insertion into Sparse Index</a></li><li><a href=#secondary-indexes>Secondary Indexes</a><ol><li></li></ol></li><li><a href=#conventional-indexes>Conventional Indexes</a><ol><li><a href=#advantages>Advantages</a></li><li><a href=#disadvantages>Disadvantages</a></li></ol></li><li><a href=#b-trees>B+ Trees</a><ol><li><a href=#b-tree-deletion>B+ Tree Deletion</a></li><li><a href=#b-tree-arithmetic>B+ Tree Arithmetic</a></li><li><a href=#balanced-multi-way-tree>Balanced multi-way tree</a></li><li><a href=#b-tree-insertion>B+ Tree Insertion</a></li><li><a href=#b-trees-vs-static-indexed-sequential-files>B+ Trees vs Static Indexed Sequential Files</a></li><li><a href=#b-trees-rules>B+ Trees Rules</a></li></ol></li><li><a href=#hashing>Hashing</a><ol><li><a href=#main-memory-hash-table>Main memory hash table</a></li><li><a href=#secondary-storage-hash-table>Secondary storage hash table</a></li><li><a href=#hashing-approach-1>Hashing Approach #1</a></li><li><a href=#hashing-approach-2>Hashing Approach #2</a></li><li><a href=#good-hash-functions>Good Hash Functions</a></li><li><a href=#hashing-example>Hashing Example</a></li><li><a href=#rule-of-thumb>Rule of Thumb</a></li><li><a href=#dynamic-hashing>Dynamic Hashing</a></li></ol></li><li><a href=#indexing-vs-hashing>Indexing vs Hashing</a></li></ol><ol><li><a href=#one-dimensional-indexes>One dimensional indexes</a></li><li><a href=#applications-of-multidimensional-access-structures>Applications of Multidimensional Access Structures</a><ol><li><a href=#geographic-information-systems>Geographic Information Systems</a></li></ol></li><li><a href=#grid-files>Grid Files</a><ol><li><a href=#advantages-3>Advantages</a></li><li><a href=#disadvantages-3>Disadvantages</a></li></ol></li><li><a href=#partitioned-hash>Partitioned Hash</a><ol><li><a href=#examples>Examples</a></li><li><a href=#advantages-4>Advantages</a></li><li><a href=#disadvantages-4>Disadvantages</a></li></ol></li><li><a href=#kd-trees>KD-Trees</a><ol><li><a href=#example-2>Example</a></li><li><a href=#partial-match-queries>Partial Match Queries</a></li><li><a href=#adapting-kd-trees-to-secondary-storage>Adapting KD-Trees to Secondary Storage</a></li></ol></li><li><a href=#quad-trees>Quad-Trees</a><ol><li><a href=#region-quad-tree>Region Quad-Tree</a></li><li><a href=#point-quad-tree>Point Quad-Tree</a></li></ol></li><li><a href=#r-trees>R-Trees</a></li><li><a href=#ub-trees>UB-Trees</a><ol><li><a href=#z-region-partition>Z-Region Partition</a></li><li><a href=#when-querying>When Querying</a></li><li><a href=#z-index>Z-Index</a></li><li><a href=#querying-ub-trees>Querying UB-Trees</a></li></ol></li><li><a href=#bitmap-indexes>Bitmap Indexes</a><ol><li><a href=#advantages-5>Advantages</a></li><li><a href=#compression>Compression</a></li><li><a href=#querying-index-involves-combining-bit-vectors-with-bitwise-operations-->Querying index involves combining bit-vectors with bitwise operations (&, |)</a></li><li><a href=#disadvantages-5>Disadvantages</a></li></ol></li></ol></nav></details></aside><a href=#access-structures><h1 id=access-structures><span class=hanchor arialabel=Anchor># </span>Access Structures</h1></a><a href=#index-basics><h2 id=index-basics><span class=hanchor arialabel=Anchor># </span>Index Basics</h2></a><p>Relations are stored in <strong>files</strong></p><p>Files are stored as collections of <strong>blocks</strong></p><p>How do we find tuples that match some criteria?</p><ul><li>Indexes<ul><li><img src=https://remnote-user-data.s3.amazonaws.com/cYW1kNWAQxVEQQwTHZFdWCqHEXmnVjzVWCOuG0Jy6OJglOxlvKQdsUBRVE6aGRQabrDKWG-daxQd91MAThs0puHd_JIJMSzQ6fglbXIwTWLVXLo_tJH0zDFCr3kk1l0L.png width=400 alt=|400></li></ul></li></ul><a href=#indexing-trade-offs><h3 id=indexing-trade-offs><span class=hanchor arialabel=Anchor># </span>Indexing Trade Offs</h3></a><p>Maintaining an index costs time</p><ul><li>When entries are added to the relation, index must be updated</li><li>Index must be maintained to make good use of resources</li></ul><p>The trade off is between</p><ul><li>Speed of updating the database</li><li>Rapid access when retrieving data</li></ul><a href=#sequential-files><h3 id=sequential-files><span class=hanchor arialabel=Anchor># </span>Sequential Files</h3></a><p>Common to leave free space in each block to allow for later insertions</p><p>Tuples are then distributed among blocks in that order</p><p>Tuples of a relation are sorted by their primary key</p><p>Blocks contain records that correspond to <strong>tuples in the relation</strong></p><a href=#dense-index><h2 id=dense-index><span class=hanchor arialabel=Anchor># </span>Dense Index</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/zYCAkNBpVTntFOyoDyr9C7gXs1wiCVDYRJMirTS7gwuF94wrvsmKOYpB2C1ba9HHMicV-jaSptiQGtpsdrsmGhRZx5Jq0y2NcoTf0FIWOWSdrcR28riVP_1ZDIAepPba.png width=400 alt=|400></p><p>Sequence of blocks holding only keys and pointers to records</p><p>One key/pointer pair for every record in data file</p><p>Blocks of index are in the same order as those of the data file</p><p>Key-pointer pair much smaller than record</p><p>Fewer blocks than data file, fewer disk accesses</p><p>Keys are sorted, so can use <strong>binary search</strong></p><p>Can keep in <strong>main memory</strong> if small enough (no disk accesses)</p><a href=#sparse-index><h2 id=sparse-index><span class=hanchor arialabel=Anchor># </span>Sparse Index</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/vyMN1X9rVvXRtG1I0StMbq1bp4XI5cC-PYwgSFZnBTSHAkCC6F4k8NzlHii515Kl_aWf_NfqISovHq7-oVwrlGlZ4zD24x5RJp855RTbGFIYyT-tlnZ6blo7XXY2zHAh.png width=400 alt=|400></p><p>One key/pointer pair for every block in data file</p><p>Can only be used if data file is sorted by search key</p><p>Uses less space than dense index</p><p>Potentially takes longer to find key than dense index</p><a href=#multi-level-index><h2 id=multi-level-index><span class=hanchor arialabel=Anchor># </span>Multi-level Index</h2></a><p>Can create a third level index, but in general prefer B-trees</p><p>Use sparse index over the first index</p><ul><li>Can&rsquo;t be a dense index (would use the same number of blocks as the index being indexed)</li></ul><p>Index file may cover many blocks</p><p>May still need many disk accesses</p><p><img src=https://remnote-user-data.s3.amazonaws.com/iMC8Uu_btJxJLLojyRnyuW-w3eWLPolasrF_rZuxnPzF5wfQ5vcusvIMUta-FYgAGzw4Xkq8qRtgNYFZP2GdsZh608Rwwa5N2CBQUn2ViUatr7xwy9DUxMLh0FeLlQO2.png width=400 alt=|400></p><a href=#notes-on-pointers><h2 id=notes-on-pointers><span class=hanchor arialabel=Anchor># </span>Notes on Pointers</h2></a><p>If the file is contiguous, then we can omit pointers</p><ul><li>Compute offset from block size and key position<ul><li>e.g. Assuming 1 kB per block and a pointer to block with key k1, to get block with key k3, use offset of (3-1)*1 = 2kB</li></ul></li></ul><p>Block pointers (as used in sparse indexes) can be smaller than record pointers (used in dense indexes)</p><ul><li>Physical record pointers consist of a block pointer and an offset</li></ul><a href=#sparse-vs-dense-tradeoff><h2 id=sparse-vs-dense-tradeoff><span class=hanchor arialabel=Anchor># </span>Sparse vs. Dense Tradeoff</h2></a><p>Sparse</p><ul><li>Less index space per record, can keep more of index in memory</li><li>Better for insertions</li></ul><p>Dense</p><ul><li>Needed for secondary indexes</li><li>Can tell if a record exists without accessing file</li></ul><a href=#duplicate-keys><h2 id=duplicate-keys><span class=hanchor arialabel=Anchor># </span>Duplicate Keys</h2></a><a href=#dense-index-approach-1><h3 id=dense-index-approach-1><span class=hanchor arialabel=Anchor># </span>Dense Index Approach #1</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/CZr4obxuvRzNexHDOuop8C_OG9jj1nsukqxiOetsUtV0QTH1uHmBneeFSRi_o7o7DX48ptr1tqRD1XL9jw9YGxUAEubOe_nGE76vG-fJG1yoS-lDBukmabOcAaYc3d_4.png width=400 alt=|400></p><p>There is an entry in the index for every record</p><a href=#dense-index-approach-2><h3 id=dense-index-approach-2><span class=hanchor arialabel=Anchor># </span>Dense Index Approach #2</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/pdf_ibWK8nAuOHCoAr-QmKnLUodU10Ds-q8_vHjACZplZuR9A5lgaf8d_aiSdhWTf0Y_Fo7YXyZuDvOchZ3rygxD_CpmeE3XHgLXpt8a9sdMUTBKSYSqNrIquAfgZ4fN.png width=400 alt=|400></p><p>There is an entry in the index for the first of each distinct record</p><p>Requires a smaller index</p><a href=#spare-index-approach-1-><h3 id=spare-index-approach-1-><span class=hanchor arialabel=Anchor># </span>Spare Index Approach #1 ↓</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/Ny5Pya7gQPJ2LTOPdPosgQmjKvHxztbdF4SPsKjG6Q_Xsvpw8selqcSKLygnCAZ0qz6UqRXBkNcktir7ljhvsSD1C9Nmhg_kpXRdRmBSnnTfgqn0FxPNOPmqqb19owvW.png width=400 alt=|400></p><p>Can miss records</p><a href=#sparse-index-approach-2-><h3 id=sparse-index-approach-2-><span class=hanchor arialabel=Anchor># </span>Sparse Index Approach #2 ↓</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/cfhBxWfdwUNbZpBUvppALgqxqHFjZfWhEbAdr5Ciq0uVwRqzW1OrR2sI0dVtVsmS8jqsRXix34jvQvj5MqZzBq1lZdHu1b4L33LbZAm62pLdZUIWhop3Zq2XV8yENHfN.png width=400 alt=|400></p><p>Index contains first new key from each block</p><p>Can exclude sequences of blocks with repeated keys by only pointing to the first instance of each value</p><p><img src=https://remnote-user-data.s3.amazonaws.com/410-QQIsdio3Tl-h1YO_NA9WvLeeJ7CWW-yH7_Zd4igENz4nOrO-ySKCccCKUtGLJkGl8R52vc04ajmysimqWQmt7QirZvUNqQj-7AGkfsi5g3UrG6xI_oYXuCPgOBRh.png width=400 alt=|400></p><a href=#deletion-from-sparse-index><h2 id=deletion-from-sparse-index><span class=hanchor arialabel=Anchor># </span>Deletion from Sparse Index</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/BQoAn9WzVP0ylkx6_HDKisT973kn6UkZ_7ymAbklI5XcnHSj__AHUNXmDrmHb_0tuykXMZrAxpi44anDHsbTlw1OibcAUJQm42oJdZhMYjkKWXjUag8mKQatLe7jOKZC.gif width=400 alt=|400></p><a href=#deletion-from-dense-index><h2 id=deletion-from-dense-index><span class=hanchor arialabel=Anchor># </span>Deletion from Dense Index</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/Dt6jEi74BEh_rC5QEqnqw_GBtQfQaYFf1U8SiNpg9he0lL5bC9FNQmYDMV3RQJWS4_ZZYdiv4_w9IXO2NkLl4c2y3kxttZ4XuwW3cTRy4r4jpqxZj9jQaYXR1SVsx3Zq.gif width=400 alt=|400></p><a href=#insertion-into-sparse-index><h2 id=insertion-into-sparse-index><span class=hanchor arialabel=Anchor># </span>Insertion into Sparse Index</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/ur_P26efRp_A3kSRoA_PB68LhEKESRT3VK9e_fcNuagigZApT0LHRSvMZd7UbMtgumiuTUktJ2gbcaBc9ojVPfMtb_izqQ2Z_lgT7eVn_X7nFKlpzAbHeOujrNTs1Is6.gif width=400 alt=|400></p><a href=#secondary-indexes><h2 id=secondary-indexes><span class=hanchor arialabel=Anchor># </span>Secondary Indexes</h2></a><p>Unlike a primary index, does not determine placement of records in data file</p><p>Location (order) of records may have been decided by a primary index on another field</p><p>Secondary indexes are always <strong>dense</strong></p><p>Pointers are record pointers, not block pointers</p><p><img src=https://remnote-user-data.s3.amazonaws.com/7fvFkd7bqP2kRuB-QN45yQ9iM0cz_Cb3vF4BMtxMxo5K1n0NxQFc4wvDxos8R0rQHlwElsx69jTwrE6xCukkkVsHg_pHk-rc-xYFZpHvT0mRLJOypoTU-nZRX9hJpW1G.png width=400 alt=|400></p><p>Secondary indexes need to cope with duplicate values in the data file</p><a href=#solution-1---repeated-entries><h4 id=solution-1---repeated-entries><span class=hanchor arialabel=Anchor># </span>Solution #1 - Repeated Entries</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/PQ2tF1maoeB1srnOdTeFQjwrY3qLOWhxJODY5_NJGLE2wrl-Hj0C9LNHmtEtZURn6lMwzGAH89dNIDlKfNASaBTgP4xySEG5BLVhbw9BwPkh-xLc7OnDrBHYstAdyN4a.png width=400 alt=|400></p><p>Problems</p><ul><li>Excess disk space</li><li>Excess search time</li></ul><a href=#solution-2---drop-repeated-keys><h4 id=solution-2---drop-repeated-keys><span class=hanchor arialabel=Anchor># </span>Solution #2 - Drop Repeated Keys</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/Cu18PnlCeaVB14UYo8Mm8g9-mEQph8J4Jm-jJxrlekY73iAjd66bS2u_EJ59bTT7uCftIjcY7-tIyLvshCdRICddSQxoqEn0Q4KAId-yvhy375zTImpAfienNVc5D8TK.png width=400 alt=|400>
Problems</p><ul><li>Variable size records in index</li></ul><a href=#solution-3---chain-records-with-same-key><h4 id=solution-3---chain-records-with-same-key><span class=hanchor arialabel=Anchor># </span>Solution #3 - Chain Records with Same Key</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/28z9G8O2vqQ3U-h1KPSoVmN9h_tuI7hTQDEdjejlGA4lebq9ScNLrHtvmIhvAZeU8EB8t9HRZ5cxBFeOiJuzRsOjgJRtqkJcwbyGkgEuoFCJuyZWMSX9b2Px4VR2CBak.png width=400 alt=|400>
Problems</p><ul><li>Need to add fields to records</li><li>Need to follow chain</li></ul><a href=#solution-4---indirection-via-buckets-of-pointers><h4 id=solution-4---indirection-via-buckets-of-pointers><span class=hanchor arialabel=Anchor># </span>Solution #4 - Indirection via Buckets of Pointers</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/1K-LLDMC7Wtocr-Wdm3h9CnSPtndVcAQxUwm1kzoQCFzy-sYc-67bEpzrbzRYhlu-WLPoqXADjVmzxioMSnLHMEI5Ee3q_DByYPvufhD4o-s4RUw6tD9ineX_Aegu74u.png width=400 alt=|400></p><p>Advantages</p><ul><li>Don&rsquo;t need to examine the data file</li><li>If we have multiple secondary indexes on a relation, we can calculate conjunctions by taking intersections of buckets</li></ul><a href=#conventional-indexes><h2 id=conventional-indexes><span class=hanchor arialabel=Anchor># </span>Conventional Indexes</h2></a><a href=#advantages><h3 id=advantages><span class=hanchor arialabel=Anchor># </span>Advantages</h3></a><ul><li>Simple</li><li>Index is sequential file and good for scans</li></ul><a href=#disadvantages><h3 id=disadvantages><span class=hanchor arialabel=Anchor># </span>Disadvantages</h3></a><ul><li>And/Or lose sequentiality and balance</li><li>Inserts expensive</li></ul><a href=#b-trees><h2 id=b-trees><span class=hanchor arialabel=Anchor># </span>B+ Trees</h2></a><p>Most widely used tree-structured indexes</p><a href=#b-tree-deletion><h3 id=b-tree-deletion><span class=hanchor arialabel=Anchor># </span>B+ Tree Deletion</h3></a><p>Coalescing is often not implemented as it is considered too hard and not worth it</p><a href=#case-4---case-2---coalesce-with-sibling-or-case-3---re-distribute-keys-at-non-leaf><h4 id=case-4---case-2---coalesce-with-sibling-or-case-3---re-distribute-keys-at-non-leaf><span class=hanchor arialabel=Anchor># </span>Case 4 - Case 2 - Coalesce with Sibling or Case 3 - Re-Distribute Keys at non-leaf</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/xvN6TU-ckTqnCMlxf4AJiXVz1azTk01W90lmC2TXyDjE5NkYNqACykqCMjVb9o475yCwsW2br9L_dkjcXeIzJMLh_mS-VDY6L9d2bqzkJDuQeIvYrb6PXf7vSnhVP0zE.gif width=400 alt=|400></p><a href=#case-2---coalesce-with-sibling><h4 id=case-2---coalesce-with-sibling><span class=hanchor arialabel=Anchor># </span>Case 2 - Coalesce with Sibling</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/3V3TSslNJnY1ppbED9GxFxzNojSDOuoiujOpemQi8A7bwds-W-yr4_3_QPUYqgt3ROKzK7oPwKwT2BMmlm23etUEe1-hxFgKZrx4oV7TdZkKinPQJT1U4FmkGg6ttfit.gif width=400 alt=|400></p><a href=#case-1---simple-case><h4 id=case-1---simple-case><span class=hanchor arialabel=Anchor># </span>Case 1 - Simple Case</h4></a><a href=#case-3---re-distribute-keys><h4 id=case-3---re-distribute-keys><span class=hanchor arialabel=Anchor># </span>Case 3 - Re-Distribute Keys</h4></a><a href=#b-tree-arithmetic><h3 id=b-tree-arithmetic><span class=hanchor arialabel=Anchor># </span>B+ Tree Arithmetic</h3></a><p>Using:</p><ul><li>b - <strong>Block size</strong> (bytes)</li><li>k - <strong>Key length</strong> (bytes)</li><li>r - <strong>Record length</strong> (bytes)</li><li>p - <strong>Block pointer</strong></li><li>u - <strong>Initial node occupancy</strong>, to allow for expansion</li></ul><p>A leaf node in a primary index can accommodate <strong>lp</strong> records</p><ul><li>Where <strong>lp</strong> = $\lfloor \frac{(b-p)}{r} \rfloor$</li></ul><p>For a secondary index:</p><ul><li>A leaf node initially points at <strong>ls * u</strong> records</li><li>A non-leaf node initially points to <strong>i * u</strong> blocks</li><li>2 levels of non-leaf nodes initially point to <strong>(ls*u)(i*u)^2</strong> records</li><li>1 level of non-leaf nodes initially points to <strong>(ls * u)(i * u)</strong> records</li></ul><p>For a primary index:</p><ul><li>1 level of non-leaf nodes initially points to <strong>(lp * u)(i * u)</strong> records</li><li>A non-leaf node initially points to <strong>i * u</strong> blocks</li><li>Each leaf initially contains <strong>lp * u</strong> records</li><li>2 levels of non-leaf nodes initially point to<ul><li><strong>(lp*u)(i*u)^2</strong>records</li><li><strong>(i*u)^2</strong> blocks</li></ul></li></ul><p>A leaf node in a secondary index can accommodate <strong>ls</strong> records</p><ul><li>Where <strong>ls</strong> =$\lfloor \frac{(b-p)}{(k+p)} \rfloor$</li></ul><p>A non-leaf node could accommodate <strong>i</strong> entries</p><ul><li>Where <strong>i</strong> =$\lfloor \frac{(b-p)}{(k+p)} \rfloor$</li></ul><a href=#balanced-multi-way-tree><h3 id=balanced-multi-way-tree><span class=hanchor arialabel=Anchor># </span>Balanced multi-way tree</h3></a><p>Yields consistent performance</p><p>Sacrifices sequentiality</p><a href=#b-tree-insertion><h3 id=b-tree-insertion><span class=hanchor arialabel=Anchor># </span>B+ Tree Insertion</h3></a><a href=#case-4---new-root><h4 id=case-4---new-root><span class=hanchor arialabel=Anchor># </span>Case 4 - New root</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/bopR3ZbRsUsFuDJZHhvmCZhXuu4PKEkCUp6vEF7ZpJqt9zFpdAtpY_96acCJMAiD-hYBDX_nVkyy9sOYe611gqB6zVcOYe83d7PDrHyfV1C07H1SWHXzI7PSpphGYl8U.gif width=400 alt=|400></p><a href=#case-3---non-leaf-overflow><h4 id=case-3---non-leaf-overflow><span class=hanchor arialabel=Anchor># </span>Case 3 - Non-leaf overflow</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/EbOAYd5hrfazHvaiBLqgMuK9YegfgjuYtD37rE0fMSsU_W7Jc0IO7070d3J6sLgppv8IkpeHHWJjm_Xv3ZUKt9EFewBRGn5_XLS1m5duyYQUPMl2XJYx0MII9uVbD3dw.gif width=400 alt=|400></p><a href=#case-2---leaf-overflow><h4 id=case-2---leaf-overflow><span class=hanchor arialabel=Anchor># </span>Case 2 - Leaf overflow</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/pzNQjnKemY1MTuLqj75RYaFO8BjfwxnPiIWpjD0fTU3o7BEomeNK0XenfwxxG5rTYcTx8wTxtm6lMUI--kW4F_O7IKTPNMP8st39EnfW4ycgAVD_ixHpJzpkbLjyDZpH.gif width=400 alt=|400></p><a href=#case-1---space-available-in-leaf><h4 id=case-1---space-available-in-leaf><span class=hanchor arialabel=Anchor># </span>Case 1 - Space available in leaf</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/qPNUcpiD6LB9Tlh2NQGlUexkdEOBr6qT6xA4yWu0ODj6fCEXU3jo7SpxvJIn_j3JaWm5ZVrXdZNpkLQuGuyfcdpXAEQtcbn4e7FL65LFQ0ISWQOAOZjwpoZqRG_mOYPg.gif width=400 alt=|400></p><a href=#b-trees-vs-static-indexed-sequential-files><h3 id=b-trees-vs-static-indexed-sequential-files><span class=hanchor arialabel=Anchor># </span>B+ Trees vs Static Indexed Sequential Files</h3></a><a href=#dba-does-not-know><h4 id=dba-does-not-know><span class=hanchor arialabel=Anchor># </span>DBA does not know</h4></a><ul><li>How full to load pages of new index</li><li>When to reorganise</li></ul><a href=#b-trees-1><h4 id=b-trees-1><span class=hanchor arialabel=Anchor># </span>B+ Trees</h4></a><ul><li>Concurrency control is harder</li><li>Consume more space</li><li>Blocks are not contiguous</li><li>Fewer disk accesses for static indexes, even allowing for reorganisation</li></ul><a href=#b-trees-rules><h3 id=b-trees-rules><span class=hanchor arialabel=Anchor># </span>B+ Trees Rules</h3></a><p>All leaves same distance from root (balanced trees)</p><p>Number of pointers/keys for B+tree of order n</p><p><img src=https://remnote-user-data.s3.amazonaws.com/72WR9yGaPb7ZCGwW_88BzfyQpgC4zs0uFU_dgaTxKuEaEg6kGVSBOwduy9M8vm-6ekrIeHrMIWUamN7jM1gZpJL8WPuvKRPBtnRKNMUhLjxEevpm30nbbhYW4lZgJDit.png width=400 alt=|400></p><p>Pointers in leaves point to records except for &ldquo;sequence pointer&rdquo;</p><p><img src=https://remnote-user-data.s3.amazonaws.com/zjPOG8tSZir_oufj3UnJcK-OyTuX-QeeEgbLc_K118DF8j3ALoIjZ2qyUvi0zy6Mr2itbsvWiGX3U5EeK8AGgZhKo_poSTerjXonhhi24e4qpwTLcMUa9FlqoYvy7ljR.png width=400 alt=|400></p><a href=#leaf-nodes><h4 id=leaf-nodes><span class=hanchor arialabel=Anchor># </span>Leaf Nodes</h4></a><ul><li><p>If the index is a primary index</p><ul><li>Leaf nodes are records containing data, stored in the order of the primary key</li><li>The index provides an alternative to a sequential scan</li><li><img src=https://remnote-user-data.s3.amazonaws.com/O4OCg6X-pe902HoLDFdZAx9XBy7qaBIvk_Fmr50XZlP5Qir0xJGfqfOzRBFIhQ6dAQUl7z63ft6oFwblfem3SIrY4R57-BcCnspKw_ToZc0dK237xT3-GeC2O6HJHMJL.png width=400 alt=|400></li></ul></li><li><p>If the index is a secondary index ↓</p><ul><li>Leaf nodes contain pointers to the data records</li><li>Data can be accessed in the sequence of the secondary key</li><li>A secondary index can point to any sort of data file, for example one created by hashing</li></ul></li></ul><a href=#non-leaf-nodes><h4 id=non-leaf-nodes><span class=hanchor arialabel=Anchor># </span>Non-leaf Nodes</h4></a><ul><li>Root node typically kept in memory<ul><li>Entrance point to index - used as frequently as any other node</li><li>Some nodes from second level may also be kept in memory</li></ul></li></ul><p><img src=https://remnote-user-data.s3.amazonaws.com/AJxyzFaEUqmdgEHCwQfjfHImDsy1OPKPFswzZ73BSOpkkLd1hW2Is9_sEcwSYY4eSAtme3CBQIB5XdjZXVo3LIDIDKeE74kszhjEA8x08myRnMuMWo-ALd_QXHsjspka.png width=400 alt=|400></p><a href=#node-size><h4 id=node-size><span class=hanchor arialabel=Anchor># </span>Node Size</h4></a><ul><li>Each node is of fixed size and contains<ul><li><strong>n</strong> keys</li><li><strong>n + 1</strong> pointers</li></ul></li></ul><a href=#minimum-nodes><h4 id=minimum-nodes><span class=hanchor arialabel=Anchor># </span>Minimum Nodes</h4></a><ul><li>Don&rsquo;t want nodes to be too empty (efficient use of space)<ul><li>Leaf -$\lfloor (n+1)/2\rfloor$ pointers</li><li>Non-leaf - $\lceil \frac{(n+1)}{2}\rceil$ pointers</li></ul></li></ul><p>Minimum Nodes Example (n=3):</p><p><img src=https://remnote-user-data.s3.amazonaws.com/Vng7pQgZNi4X7ve88IjpGwf2PwLJ4wQw9FXKuVxsVMZX_8COQ6rAsPG-d26p7mxfZ1YbOlB9kK94rl8X5-4SbEfwItvEvbAZa_d4xM26Koz8zxbDcTgT1SO4WbCB6eRf.png width=400 alt=|400></p><a href=#hashing><h2 id=hashing><span class=hanchor arialabel=Anchor># </span>Hashing</h2></a><a href=#main-memory-hash-table><h3 id=main-memory-hash-table><span class=hanchor arialabel=Anchor># </span>Main memory hash table</h3></a><p>Value is used to select a <strong>bucket from a bucket array</strong></p><p>Bucket array contains <strong>linked lists of records</strong></p><p>Hash function <strong>h()</strong> takes a key and computes an integer value</p><a href=#secondary-storage-hash-table><h3 id=secondary-storage-hash-table><span class=hanchor arialabel=Anchor># </span>Secondary storage hash table</h3></a><p>Stores <strong>many more</strong> records than a main memory hash table</p><p>Bucket array consists of <strong>disk blocks</strong></p><a href=#hashing-approach-1><h3 id=hashing-approach-1><span class=hanchor arialabel=Anchor># </span>Hashing Approach #1</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/4wXNx3b1ju-tfHGFYshIVHGkhooeyV-zDS37t6m43b42fAWh9lfx2WcN2dD4-kf6OpCWVwS8MvRDZXo_OT1TWbskQ4qeg-AzFB3NTcLzjo_k3dwnAHhOL29MCSzKP6Xi.png width=400 alt=|400></p><p>Has function calculate block pointer directly, or as offset from first block</p><p>Requires bucket blocks to be in fixed, consecutive locations</p><a href=#hashing-approach-2><h3 id=hashing-approach-2><span class=hanchor arialabel=Anchor># </span>Hashing Approach #2</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/HINHg3DgUSR0fBYIfnF55qVUKsK68kbuDFHqYlZh3y-ZBmBNYiRmHgMS2cSHIlB_IaVC6Buwdr4uFoHB0qIqaKhI1Azdbs-M-NlShPqlKymNCkv82tvZGNfHoLaNjKUP.png width=400 alt=|400></p><p>Hash function calculates offset in array of block pointers</p><p>Used for &lsquo;secondary&rsquo; search keys</p><a href=#good-hash-functions><h3 id=good-hash-functions><span class=hanchor arialabel=Anchor># </span>Good Hash Functions</h3></a><p>Good hash functions have <strong>the same expected number of keys</strong> per bucket</p><p>Keys are kept sorted in buckets if <strong>CPU time is critical and inserts/deletes are relatively infrequent</strong></p><a href=#hashing-example><h3 id=hashing-example><span class=hanchor arialabel=Anchor># </span>Hashing Example</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/ApwBHDVzoxIc_Ki7CmKh0naJZOOboSw_d4QLKQyQoig_33Pmdrc3YWvvVjmlAtJrdTl2NfX2gVwG3lGTIHpWZdkXGbL-SON7mthozQZirk9MWGqbCNsdImK3sE0SFmOH.gif width=400 alt=|400></p><a href=#rule-of-thumb><h3 id=rule-of-thumb><span class=hanchor arialabel=Anchor># </span>Rule of Thumb</h3></a><p>Space utilisation should be between <strong>50% and 80</strong>%</p><p>Utilisation = <strong>#keys used / total #keys that fit</strong></p><p>If &lt; <strong>50</strong>%, wasting space</p><p>If > <strong>80</strong>%, overflows significant</p><a href=#dynamic-hashing><h3 id=dynamic-hashing><span class=hanchor arialabel=Anchor># </span>Dynamic Hashing</h3></a><p>Used to cope with <strong>growth</strong></p><a href=#linear-hashing><h4 id=linear-hashing><span class=hanchor arialabel=Anchor># </span>Linear Hashing</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/_-7kAl3vP7fRQRSWax7tUf71oBj81M48u0mUCotr0hOdEx6mN5ZtKo9gqukANGyZS456Iq9s8-OV0aCQmcQRE7bmSNBSkWif4mpuE6Af9WxkrEDEd68My7oJH6zAAQQP.png width=400 alt=|400></p><p>Combination of two ideas</p><ul><li>Use <strong>i</strong> least significant bits of hash</li><li>Hash file grows incrementally and linearly<ul><li>Unlike extensible hash file, which periodically doubles</li></ul></li></ul><a href=#example><h5 id=example><span class=hanchor arialabel=Anchor># </span>Example</h5></a><p><img src=https://remnote-user-data.s3.amazonaws.com/xw7Rgs09zfRditPwz_YYui4M6kN0VHoD98mstiGSxnk6PXbWOzxcJNhem7PfZt3ZldKDuUgN34oFp03xKAEGxx2Qc4t7jSSUwHzEnxSiWsrLTecTE6qpHwRzBcG2b7qv.gif width=400 alt=|400></p><p>Lookup Rule</p><ul><li>m is the greatest suffix associated with any bucket</li></ul><p>When to expand file?</p><ul><li>If U > threshold, then increase <strong>m</strong> ( and potentially <strong>i</strong> )</li><li>Utilisation (U) = #used slots / total #slots</li></ul><a href=#disadvantages-1><h5 id=disadvantages-1><span class=hanchor arialabel=Anchor># </span>Disadvantages</h5></a><ul><li>Can still have overflow chains</li></ul><a href=#advantages-1><h5 id=advantages-1><span class=hanchor arialabel=Anchor># </span>Advantages</h5></a><ul><li>Can handle growing files with less wasted space and no full reorganizations</li><li>No indirection like extensible hashing</li></ul><a href=#extensible-hashing><h4 id=extensible-hashing><span class=hanchor arialabel=Anchor># </span>Extensible Hashing</h4></a><a href=#disadvantages-2><h5 id=disadvantages-2><span class=hanchor arialabel=Anchor># </span>Disadvantages</h5></a><ul><li>Directory doubles in size<ul><li>Suddenly increases in disk accesses</li></ul></li><li>Indirection<ul><li>Not bad if <strong>directory in memory</strong></li></ul></li></ul><a href=#deletion><h5 id=deletion><span class=hanchor arialabel=Anchor># </span>Deletion</h5></a><ul><li>No merging of blocks</li><li>(Reverse insert procedure)</li><li>Merge blocks and cut directory if possible</li></ul><a href=#combination-of-two-ideas><h5 id=combination-of-two-ideas><span class=hanchor arialabel=Anchor># </span>Combination of two ideas</h5></a><ul><li>Use i of b bits output by hash function, where <strong>i</strong> grows over time</li></ul><p><img src=https://remnote-user-data.s3.amazonaws.com/2iUHZ8KQIZqKYQDNxf1pU18dKKRS_n_ozRfuYyWjMesvMYAzMmsFplGhti_ch4KGPxE8KUl01-h4MYlp2t61cbL4tQ8-wbu2J2KoCWbBX0z_HkRfuSm1j5k4T8D_ja6s.png width=400 alt=|400></p><ul><li>Use a directory</li></ul><p><img src=https://remnote-user-data.s3.amazonaws.com/LW5_MB2V7F0z4sAqpmt0bKL_g5FBQxc5hmnHnDDFH3Z2yaJ-jikbKHcw7HqCUpOt9dhn-TJ5XWc-t21989zgKnDzNjwG4Zju5G_njJrW5PXhyOeOaqbm_yDjVTsZ4CY6.png width=400 alt=|400></p><a href=#example-1><h5 id=example-1><span class=hanchor arialabel=Anchor># </span>Example</h5></a><p><img src=https://remnote-user-data.s3.amazonaws.com/e-CYk338s-1BRAfed33AuKTjUw9ZpKK-9e_9TVg6fE1xFM9tFsnrqGOq6oV4I28qBt8zz_nphFi43VFDdjiiWYBXj8lopRC8UKwm82kH_4DMpHRtge4zpAl_vxyccF4g.gif width=400 alt=|400></p><a href=#overflow-chains><h5 id=overflow-chains><span class=hanchor arialabel=Anchor># </span>Overflow Chains</h5></a><p>Chaining overflow blocks when many records have duplicate keys</p><p><img src=https://remnote-user-data.s3.amazonaws.com/ozZ7oQlSM33IiUDlmE9mSB5AizlS6ehgc0J4SThWC4HF2dpyROCTqfvlDHmcKyc-kAgRT1wW5Zrk9lmTEGDrhnAy-yaXiY9hGlbq-eZBqMt53acT3a3HXDGnI16Qx44F.png width=400 alt=|400></p><a href=#advantages-2><h5 id=advantages-2><span class=hanchor arialabel=Anchor># </span>Advantages</h5></a><ul><li>Can handle growing files with less wasted space and no full reorganizations</li></ul><a href=#indexing-vs-hashing><h2 id=indexing-vs-hashing><span class=hanchor arialabel=Anchor># </span>Indexing vs Hashing</h2></a><p>Hashing is good for <strong>probes</strong> given a key</p><p>Indexing (including B-Trees) is good for <strong>range searches</strong></p><a href=#multidimensional-access-structures><h1 id=multidimensional-access-structures><span class=hanchor arialabel=Anchor># </span>Multidimensional Access Structures</h1></a><a href=#one-dimensional-indexes><h2 id=one-dimensional-indexes><span class=hanchor arialabel=Anchor># </span>One dimensional indexes</h2></a><p>Assume a single search key</p><p>Require a single linear order for keys (B-trees)</p><p>Require that the key be completely known for any lookup (hash tables)</p><a href=#applications-of-multidimensional-access-structures><h2 id=applications-of-multidimensional-access-structures><span class=hanchor arialabel=Anchor># </span>Applications of Multidimensional Access Structures</h2></a><a href=#geographic-information-systems><h3 id=geographic-information-systems><span class=hanchor arialabel=Anchor># </span>Geographic Information Systems</h3></a><p>Nearest-neighbour queries</p><p>Range queries</p><p>Partial match queries</p><a href=#grid-files><h2 id=grid-files><span class=hanchor arialabel=Anchor># </span>Grid Files</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/u6HUicGE4avUkuvbY39MR2ybgTZWVZJg7ZqITl4SpaPvMjt_RIILAjMYSTtKXT5rTZMvkPi57fHjymQnVhA0bVQjGEs801YTnlzLeuiWDap_MkB4c9bTi-w9KyBB-sI6.png width=400 alt=|400></p><p>Each region is associated with a pointer to a bucket of record pointers</p><p>Partition multidimensional space with a grid</p><p>Fixed number of regions</p><ul><li>Overflow buckets used to increase bucket size as necessary</li></ul><p>Grid lines partition space into <strong>stripes</strong></p><p>Intersection of <strong>stripes from different dimensions define regions</strong></p><p><strong>Attribute values</strong> for a record determine the region and therefore the bucket</p><a href=#advantages-3><h3 id=advantages-3><span class=hanchor arialabel=Anchor># </span>Advantages</h3></a><ul><li>Good for multiple-key search</li><li>Supports partial-match, range and nearest-neighbour queries</li></ul><a href=#disadvantages-3><h3 id=disadvantages-3><span class=hanchor arialabel=Anchor># </span>Disadvantages</h3></a><ul><li>Space, management overhead</li><li>Need partitioning ranges that evenly split keys</li></ul><a href=#partitioned-hash><h2 id=partitioned-hash><span class=hanchor arialabel=Anchor># </span>Partitioned Hash</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/hETPqr9jSI0dYbjEMQpdBa7qi14BnM0MjB0gNa9pvm7lAfOMkGOf03ejDQtSrY6UIIFX4U5w_hfGVwOEwGRv9OEhjc-UxaRe9ym5qbCQDMr4uynwTRwiqTKjRxngSES-.png width=400 alt=|400></p><p>Hash function takes a list of attribute values as arguments</p><p>Bits of hash value divided between attributes</p><p>Effectively a hash function per attribute</p><a href=#examples><h3 id=examples><span class=hanchor arialabel=Anchor># </span>Examples</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/CYdJfkY8zvhZy5vfi9bHtkNtt0xhQpvk15MOGru6EZl3lZTfPAikDf5Dd2RpyBasGSiq66iAlXeE2RnjXCbeSLyiYaTXBFootUar8hpDbb7xVmnB_XUYVtlA4kaPwz-n.gif width=400 alt=|400></p><a href=#advantages-4><h3 id=advantages-4><span class=hanchor arialabel=Anchor># </span>Advantages</h3></a><ul><li>Good hash function will evenly distribute records between buckets</li><li>Supports partial-match queries</li></ul><a href=#disadvantages-4><h3 id=disadvantages-4><span class=hanchor arialabel=Anchor># </span>Disadvantages</h3></a><ul><li>No good for nearest-neighbour or range queries</li></ul><a href=#kd-trees><h2 id=kd-trees><span class=hanchor arialabel=Anchor># </span>KD-Trees</h2></a><p>Multidimensional binary search tree</p><p>Each node splits the k-dimensional space along a hyperplane</p><p>Nodes contain</p><ul><li>An attribute value pair</li><li>A pair of pointers</li></ul><p>All nodes at the same level discriminate for the same attribute</p><p>Levels rotate between attributes of all dimensions</p><a href=#example-2><h3 id=example-2><span class=hanchor arialabel=Anchor># </span>Example</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/aE8McSblNWRnwwZlzre9ZiVN2vAE1Rp-FEzIHr-9bWJod37l4pqsvEovEC-dzbKLnzmAZsMayqm11liUbj4fXmGPQGxxNqsUpbiBXlZHPxjE6Fu_y48xch7r9v5hDR_t.png width=400 alt=|400></p><a href=#partial-match-queries><h3 id=partial-match-queries><span class=hanchor arialabel=Anchor># </span>Partial Match Queries</h3></a><p>If we know the value of the attribute, we can choose which branch to explore</p><p>If we don&rsquo;t know the value of the attribute, we must explore all branches</p><a href=#adapting-kd-trees-to-secondary-storage><h3 id=adapting-kd-trees-to-secondary-storage><span class=hanchor arialabel=Anchor># </span>Adapting KD-Trees to Secondary Storage</h3></a><p>The average path length from root to leaf is $\log_2n$</p><p>Disk accesses should be kept as few as possible</p><ul><li>Approaches<ul><li>Group nodes in blocks</li><li>Multiway nodes (split values into n ranges)</li></ul></li></ul><a href=#quad-trees><h2 id=quad-trees><span class=hanchor arialabel=Anchor># </span>Quad-Trees</h2></a><a href=#region-quad-tree><h3 id=region-quad-tree><span class=hanchor arialabel=Anchor># </span>Region Quad-Tree</h3></a><p>Each partition divides the space into four equal area sub-regions</p><ul><li>ne, nw, se, sw</li></ul><p>Split regions if they contain more records than will fit into a block</p><p><img src=https://remnote-user-data.s3.amazonaws.com/w8jhHMP4o-Kt70TsTEuwNihaHQNiij8y6P8eQfgvQGxCD0RijuUUIlGSuCY21_xMTnYObFRn_Ft6Hr3ks6zef1jD30jSIQQstxQouGKJyk7R_HzxJP70UleiQjp1298d.png width=400 alt=|400></p><p>Operations similar to those for [KD-Trees](Advanced Databases/Week 3/Multidimensional Access Structures/KD-Trees.md)</p><a href=#point-quad-tree><h3 id=point-quad-tree><span class=hanchor arialabel=Anchor># </span>Point Quad-Tree</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/DMVOht21glVHEwWAJlPt3X15ZBcfR04mBZ_jRa-JTYH9FYugoAT2dZusXd7G_K2gfk_seTei9UBmbvjZ8CgMRq06vfpn1ffQH9us3xJ3QLcMjHSfZxmunn0DRWd-nTDv.png width=400 alt=|400></p><p>Partitions are not equal area</p><ul><li>Split lines centred on data points</li><li>ne/nw/se/sw sub-regions</li></ul><p>Otherwise equivalent to [Region Quad-Tree](Advanced Databases/Week 3/Multidimensional Access Structures/Quad-Trees/Region Quad-Tree.md)</p><a href=#r-trees><h2 id=r-trees><span class=hanchor arialabel=Anchor># </span>R-Trees</h2></a><p><img src=https://remnote-user-data.s3.amazonaws.com/ksGJOH2ILYBpYAXDY2HL26Y54Le6IFdzzOOCaKOXV-DtQli3nhehfnPgqmKctJsiWr2eW-gdFXVBdN73utiqFEnFuTGzIQdpU-u_AiX3uMImcaDUzEyhGq1UNIUrfyNd.png width=400 alt=|400></p><p>Used to represent data that consists of k-dimensional data regions</p><p>Internal nodes of tree represent regions that contain data regions</p><p>Regions typically defined as top-right, bottom-left coordinates</p><a href=#ub-trees><h2 id=ub-trees><span class=hanchor arialabel=Anchor># </span>UB-Trees</h2></a><a href=#z-region-partition><h3 id=z-region-partition><span class=hanchor arialabel=Anchor># </span>Z-Region Partition</h3></a><p><img src=https://remnote-user-data.s3.amazonaws.com/hfNsK3Of2Diu85RbGEo1cU_IGpXet7CLUAxq_sV_NjHVBNFZ4wSfFu0VenUyYJ89gCgUEGBmmli1zqDZw9BYY5cWs9lm3UNZzCGR-tpKD54yPgDBWennuolBSjfEu9ds.png width=400 alt=|400></p><p>Z-Regions→Z-curve partitioned into contiguous regions</p><ul><li>May not be contiguous regions in the multidimensional space</li></ul><p>A leaf node contains pointers to records whose attribute value locate them within the associated Z-region</p><p>[Z-Regions](Advanced Databases/Week 3/Multidimensional Access Structures/UB-Trees/Z-Region Partition/Z-Regions.md) mapped to leaf nodes of a B+tree</p><a href=#when-querying><h3 id=when-querying><span class=hanchor arialabel=Anchor># </span>When Querying</h3></a><p>When querying, identify regions of n-dimensional space (e.g. segments of 1-dimensional line) that intersect with query rectangle</p><p>Partition ranges and index using a B+Tree</p><p><img src=https://remnote-user-data.s3.amazonaws.com/DXgCfCOIJLh0TlyECsOOs4f2LDrunS-EO_yxHuzDAjQCOJvum_egZ3F5qEZJ8gPFNa0ZvcRqn7ekRuyPKgF60IphnC_YqNDtsbIzlTtmQ4gsvIUfmPGTomIRSUd60EWX.png width=400 alt=|400></p><p>Map n-dimensional space onto a 1-dimensional line using a fractal space-filling curve</p><a href=#z-index><h3 id=z-index><span class=hanchor arialabel=Anchor># </span>Z-Index</h3></a><ul><li>$y=y_1y_2$</li><li>$x=x_1x_2$</li></ul><p>Order of points on Z-curve given by bit-interleaving the positions on the axes</p><ul><li>$\text{z-index}=y_1x_1y_2x_2$</li></ul><p><img src=https://remnote-user-data.s3.amazonaws.com/lbP-ccpPQbl3BimO4DlYvsUwPFtBQWn39im4TL95uJ3iN31BTFG93cFBoM3_d9y9YMNYwNvwpccuPrwPEpoc_B1GsXeb1_2NYIaVIbjD5OpntYKzyJ8PLMu1gRuxX59E.png width=400 alt=|400></p><p>Map domain of each attribute onto n-bit integer</p><a href=#querying-ub-trees><h3 id=querying-ub-trees><span class=hanchor arialabel=Anchor># </span>Querying UB-Trees</h3></a><p>Algorithm identifies [Z-Regions](Advanced Databases/Week 3/Multidimensional Access Structures/UB-Trees/Z-Region Partition/Z-Regions.md) that intersect with the query rectangle</p><p><img src=https://remnote-user-data.s3.amazonaws.com/itTv9ewkQ8OmhwVcSrT-tr-dKQoZAxtM0zX79-r28RyA_tu0NU6xndlLWXui8P3bXYzerqJqhCzGeBDOU4iS16AI9x_U2eh1dC28yRR3jIJu1fBR_O8o1Ud80wmLIk88.png width=400 alt=|400></p><p>Multidimensional range query can be considered as a k-dimensional rectangle</p><a href=#bitmap-indexes><h2 id=bitmap-indexes><span class=hanchor arialabel=Anchor># </span>Bitmap Indexes</h2></a><p>Collection of bit-vectors used to index an attribute</p><ul><li>One bit-vector for each unique attribute value</li><li>One bit for each record</li></ul><a href=#advantages-5><h3 id=advantages-5><span class=hanchor arialabel=Anchor># </span>Advantages</h3></a><ul><li>Efficient answering of partial-match queries</li></ul><a href=#compression><h3 id=compression><span class=hanchor arialabel=Anchor># </span>Compression</h3></a><p>Bit-vectors are typically sparse, with few 1 bits</p><ul><li>Run-length encoding of bit-vectors to reduce stored size</li><li>Large amount of wasted space</li></ul><p>Bitwise operations must be applied to original bit-vectors</p><ul><li>Can decode RLE bit-vectors one run at a time</li></ul><a href=#querying-index-involves-combining-bit-vectors-with-bitwise-operations--><h3 id=querying-index-involves-combining-bit-vectors-with-bitwise-operations--><span class=hanchor arialabel=Anchor># </span>Querying index involves combining bit-vectors with bitwise operations (&, |)</h3></a><p>A 1 in the <strong>i</strong>th position indicates that record <strong>i</strong> is a match</p><a href=#example-3><h4 id=example-3><span class=hanchor arialabel=Anchor># </span>Example</h4></a><p><img src=https://remnote-user-data.s3.amazonaws.com/SBogJweGUk5AXLquy6X0UFbpfd0eezf0XsEoPAI-lEebG91W0KvlV20wJPi5xfpdPavKS_q9FBZIf9h7GPKpfiKHvfNM4dFQdjUGXqaR3C1AW6cMFJEkBucj3gPRxA2T.png width=400 alt=|400></p><p><img src=https://remnote-user-data.s3.amazonaws.com/VO6bnYuA4bsh5aMdtSqIiaUeUNdDcJ1OnRnzbMM9sBgAI_2unkkuD_JbuzALDvS676IPmtDEumkTW-boiOLNmBLYm8U32ALa-VAXoDYo-ez7NTn1nsdHq4iIZUW-qqYq.png width=400 alt=|400></p><a href=#disadvantages-5><h3 id=disadvantages-5><span class=hanchor arialabel=Anchor># </span>Disadvantages</h3></a><ul><li>Requires fixed record numbers</li><li>Changes to data file require changes to bitmap index</li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://ik1g19.github.io/UoS-Notes/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Isaac Klugman using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://ik1g19.github.io/UoS-Notes/>Home</a></li><li><a href=https://twitter.com/_jzhao>Twitter</a></li><li><a href=https://github.com/jackyzha0>GitHub</a></li></ul></footer></div></div></body></html>